<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>微擎框架基本操作 | abellmz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="公众平台说明 公众号分为个人（只能申请订阅号，不可认证）和企业（服务号、订阅号，可认证），订阅号每天可发文章，在订阅列表中，服务号1个月4篇文章，在微信列表，权限、功能更强大。未认证的订阅号很多接口无法对接，比如支付，不仅要认证还要申请支付通道。">
<meta property="og:type" content="article">
<meta property="og:title" content="微擎框架基本操作">
<meta property="og:url" content="http://yoursite.com/2019/09/17/%E5%BE%AE%E6%93%8E%E6%A1%86%E6%9E%B6%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/index.html">
<meta property="og:site_name" content="abellmz">
<meta property="og:description" content="公众平台说明 公众号分为个人（只能申请订阅号，不可认证）和企业（服务号、订阅号，可认证），订阅号每天可发文章，在订阅列表中，服务号1个月4篇文章，在微信列表，权限、功能更强大。未认证的订阅号很多接口无法对接，比如支付，不仅要认证还要申请支付通道。">
<meta property="og:locale">
<meta property="article:published_time" content="2019-09-17T04:26:50.000Z">
<meta property="article:modified_time" content="2024-12-20T07:41:58.831Z">
<meta property="article:author" content="abellmz">
<meta property="article:tag" content="PHP-framework">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="abellmz" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">abellmz</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-微擎框架基本操作" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/09/17/%E5%BE%AE%E6%93%8E%E6%A1%86%E6%9E%B6%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" class="article-date">
  <time datetime="2019-09-17T04:26:50.000Z" itemprop="datePublished">2019-09-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      微擎框架基本操作
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="公众平台说明"><a class="markdownIt-Anchor" href="#公众平台说明"></a> <strong>公众平台说明</strong></h3>
<p>公众号分为个人（只能申请订阅号，不可认证）和企业（服务号、订阅号，可认证），订阅号每天可发文章，在订阅列表中，服务号1个月4篇文章，在微信列表，权限、功能更强大。未认证的订阅号很多接口无法对接，比如支付，不仅要认证还要申请支付通道。</p>
<span id="more"></span>
<p>企业微信一般是针对企业内部管理的。</p>
<p>同一个人的小程序和公众号的appid是性质一样，都是applicationidentification，但他们两者之间的APP ID号是不同，每个公众平台账号都有一个单独的APP ID，就像身份证号码一样，具有唯一性。</p>
<h3 id="微擎简介"><a class="markdownIt-Anchor" href="#微擎简介"></a> <strong>微擎简介</strong></h3>
<p>微擎是一款小程序和公众号管理系统，可以实现微信平台（<a href="https://mp.weixin.qq.com/">mp.weixin.qq.com</a>）不能实现的功能，例如商城，餐饮，酒店，汽车，门店，同城，各类行业解决方案，营销，推广，吸粉，游戏，物联网和人工智能等功能。</p>
<p>1：系统百分百开源，方便二次开发。<br>
2：软件和数据保存在自己的服务器上，使用的自己的域名，安全性较高。<br>
3：微擎分为付费版和免费版，全方面覆盖企业商业运营和个人测试使用需求。<br>
4：基于目前最流行的WEB2.0的架构（php+mysql），运行环境推荐使用linux(centOS)+ nginx + php5.3，mysql5.6。<br>
5：微擎拥有开发者认证机制，上万开发团队基于微擎系统开发插件，用户可以直接购买这类插件，无需再次开发，降低成本。</p>
<p>已经安装微擎系统的用户可以在应用商城（<a href="http://s.we7.cc/">s.we7.cc</a>）购买自己所需要的插件，这类插件可以广泛的应用在小程序，公众号，PC网页，前台模板，微站模板等</p>
<h3 id="微擎mvc"><a class="markdownIt-Anchor" href="#微擎mvc"></a> 微擎MVC</h3>
<p>使用的是微擎系统，按照微擎语法来使用</p>
<p>所有模板缓存均被解析成php文件存放在./data/tpl中, 以 “模板标示符.tpl.php”形式保存。</p>
<p>在开发模块时模块内部应该使用 $this-&gt;template() 函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$_GPC 全局请求变量, 获取 $GET, $POST, $_COOKIES 中的变量</span><br><span class="line">$_W（大写W）,是系统中最为重要的全局变量，微擎系统中很多常用的数据都存储在这个变量之中</span><br></pre></td></tr></table></figure>
<p>同一个微信号appid是唯一的，对应同一个小程序中openid是唯一的。</p>
<p>$_w的相关数据查询</p>
<p>参考链接：</p>
<p><a href="https://blog.csdn.net/minato_wdz/article/details/78420624">https://blog.csdn.net/minato_wdz/article/details/78420624</a></p>
<p>M:</p>
<p>位于 framework/model 目录下，每一个文件代表一个独立的功能模型，模型通常会与控制器对应。加载模型时以可使用 [load() 函数](</p>
<p>V:</p>
<p>位于 [web|app]/themes/default/ 中，模板文件与 controller, action 对应，系统提供了简单的模板引擎机制，具体请参看[模板引擎](</p>
<p>C:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">控制器以文件夹、文件的形式组织，位于系统的 source 目录下，每一个目录代表一个 controller ，文件夹中的每个文件即为一个 action（参数a）。某些情况，一个action可能可能会包含多个操作，系统中提供 do参数来用于区分同一个 action 中的不同操作(细分的控制器名) 。</span><br></pre></td></tr></table></figure>
<p>即控制器位于source/controller,每个controller称为一个action，一个controller包括a参数和do参数来规定它的行为</p>
<h3 id="微擎目录结构"><a class="markdownIt-Anchor" href="#微擎目录结构"></a> 微擎目录结构：</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">addons:模块安装目录</span><br><span class="line">api:外部接口文件</span><br><span class="line">app:控制微信访问的部分控制器</span><br><span class="line">attachment:用户上传文件目录</span><br><span class="line">data:日志、缓存</span><br><span class="line">errpage:错误跳转页面（404等等）</span><br><span class="line">framework:框架核心文件（包括function/class/modul）</span><br><span class="line">payment:支付代码</span><br><span class="line">web:web端公共文件、控制器、资源、后台前端页面等</span><br><span class="line"></span><br><span class="line">api.php：公众号、站点接口文件</span><br><span class="line">index.php:首页指向引导文件</span><br><span class="line">install.php:安装文件，建议安装后删除</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">├─ framework </span><br><span class="line">│ ├─ builtin ……………………………………【微擎内建模块，很少用】 </span><br><span class="line">│ │ ├─ basic 文字回复模块 </span><br><span class="line">│ │ ├─ core 会话消息统计 </span><br><span class="line">│ │ ├─ cover 通用封面回复 </span><br><span class="line">│ │ ├─ default 默认回复模块 </span><br><span class="line">│ │ ├─ music 音乐回复模块 </span><br><span class="line">│ │ ├─ news 图文回复模块 </span><br><span class="line">│ │ ├─ userapi 自定义接口回复模块（此处的模块目录结构和addons区别不大） </span><br><span class="line">│ │ │ ├─ api 功能文件目录 </span><br><span class="line">│ │ │ │ ├─ baike.php 百科 </span><br><span class="line">│ │ │ │ ├─ calendar.php 万年历 </span><br><span class="line">│ │ │ │ ├─ express.php 快递 </span><br><span class="line">│ │ │ │ ├─ news.php 新闻 </span><br><span class="line">│ │ │ │ ├─ translate.php 翻译 </span><br><span class="line">│ │ │ │ ├─ weather.php 天气 </span><br><span class="line">│ │ │ │ └─ … 可模仿其他文件做扩展 </span><br><span class="line">│ │ └─ … . </span><br><span class="line">│ ├─ class ………………………………………… 工具类（可以在里面加自己定义的函类文件，比较常用） </span><br><span class="line">│ │ ├─ loader.class.php 文件加载器 </span><br><span class="line">│ │ ├─ db.class.php 数据库操作类 </span><br><span class="line">│ │ ├─ account.class.php 公众号业务操作基类 </span><br><span class="line">│ │ ├─ weixin.account.class.php 微信公众号业务操作(微信开发文档中的接口，都在此被封装为了函数 例如：数据统计、消息群发、素材上传发送等等) </span><br><span class="line">│ │ ├─ yixin.account.class.php 易信 </span><br><span class="line">│ │ └─ … . </span><br><span class="line">│ ├─ function …………………………………… 工具函数（可以在里面加自己定义的函数，比较常用） </span><br><span class="line">│ │ ├─ global.func.php 全局通用函数 </span><br><span class="line">│ │ ├─ cache.file.func.php 文件缓存 </span><br><span class="line">│ │ ├─ cache.func.php 缓存功能 </span><br><span class="line">│ │ ├─ cache.memcache.func.php 插件缓存 </span><br><span class="line">│ │ ├─ cache.mysql.func.php mysql缓存 </span><br><span class="line">│ │ ├─ communication.func.php http 通信（ihttp_request函数等） </span><br><span class="line">│ │ ├─ compat.biz.func.php 兼容函数(业务功能) </span><br><span class="line">│ │ ├─ compat.func.php 兼容函数(逻辑功能) </span><br><span class="line">│ │ ├─ file.func.php 文件操作 </span><br><span class="line">│ │ ├─ logging.func.php 日志记录 </span><br><span class="line">│ │ ├─ pdo.func.php 数据库访问操作 </span><br><span class="line">│ │ ├─ db.func.php 数据库信息相关操作 </span><br><span class="line">│ │ └─ tpl.func.php 自定义模板控件 </span><br><span class="line">│ ├─ library ……………………………………… 其他函数库 </span><br><span class="line">│ ├─ model ………………………………………… 业务功能模块(主要是微擎框架本身来调用，一般用不到) </span><br><span class="line">│ │ ├─ account.mod.php 公众号相关操作 </span><br><span class="line">│ │ ├─ activity.mod.php 营销活动 </span><br><span class="line">│ │ ├─ app.mod.php APP 端相关操作 </span><br><span class="line">│ │ ├─ cache.mod.php 缓存 </span><br><span class="line">│ │ ├─ cloud.mod.php 云服务 </span><br><span class="line">│ │ ├─ extension.mod.php 扩展功能 </span><br><span class="line">│ │ ├─ mc.mod.php 会员功能 </span><br><span class="line">│ │ ├─ module.mod.php 公众号 </span><br><span class="line">│ │ ├─ payment.mod.php 支付功能 </span><br><span class="line">│ │ ├─ reply.mod.php 规则回复 </span><br><span class="line">│ │ ├─ setting.mod.php 读写系统设置缓存 </span><br><span class="line">│ │ ├─ user.mod.php 操作用户 </span><br><span class="line">│ │ └─ utility.mod.php </span><br><span class="line">│ ├─ bootstrap.inc.php 核心文件 </span><br><span class="line">│ ├─ const.inc.php 全局常量定义文件 </span><br><span class="line">│ └─ version.inc.php 版本号 信息定义文件</span><br><span class="line"></span><br><span class="line">bootstrap.inc.php 文件：$_W、$_GPC数组数据收集就是从这开始的 。还有个常用的：53行代码：define(&#x27;DEVELOPMENT&#x27;, $_W[&#x27;config&#x27;][&#x27;setting&#x27;][&#x27;development&#x27;] == 1); 改为0，就是开发者模式。 </span><br><span class="line">有时出错，页面出现空白， 此处改为开发者模式的话，就会出现报错信息了。 </span><br><span class="line">此文件中也有常量、路径等定义。</span><br><span class="line">还有一些公用的方法在web/common 文件夹内 </span><br><span class="line">微擎封装好的message、url、checklogin、checkaccount、buildframes等方法在common.fun.php文件内. </span><br><span class="line">封装的tpl_*** 函数，比如上传图片、富文本编辑器。。。函数在tpl.func.php文件内. </span><br><span class="line">微擎的框架信息文件为 frames.inc.php</span><br></pre></td></tr></table></figure>
<p>参考链接：<a href="https://blog.csdn.net/qq_39702981/article/details/82788225">https://blog.csdn.net/qq_39702981/article/details/82788225</a></p>
<h3 id="微擎模板中的语法"><a class="markdownIt-Anchor" href="#微擎模板中的语法"></a> 微擎模板中的语法：</h3>
<p>变量输出-<code>&#123;$var&#125;</code></p>
<p>等同于<code>&lt;?php echo $var;?&gt;</code>，使用花括号包含的变量将直接输出至页面</p>
<p>支持直接输出数组元素或嵌套数组元素</p>
<p><code>&#123;$row['name']&#125; &#123;$_W['member']['username']&#125;</code></p>
<p>一般情况模板引擎能自动识别 javascript 中的花括号和变量输入的花括号. 如果遇到程序不能自动分辨的情况可以强制使用 “” 符号来代表 “}”</p>
<p>条件语法 - <code>&#123;if condition&#125;&#123;/if&#125;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if与逻辑运算符 </span><br><span class="line">&#123;if $row[&#x27;flag&#x27;] ==&#x27;-1&#x27;&amp;&amp; $row[&#x27;role&#x27;]!= &#x27;admin&#x27;&#125;被禁用&#123;/if&#125;</span><br><span class="line">使用 &#123;else&#125; 来扩充条件判断, 例如:</span><br><span class="line">&#123;if $row[&#x27;role&#x27;] == &#x27;admin&#x27;&#125; 管理员 &#123;else&#125; 普通用户 &#123;/if&#125;</span><br><span class="line">可以使用 &#123;else if condition&#125; 来进行多个条件的判断, 例如:</span><br><span class="line">&#123;if $row[&#x27;role&#x27;] == &#x27;founder&#x27;&#125; 创始人 &#123;else if $row[&#x27;role&#x27;] == &#x27;admin&#x27;&#125; 管理员 &#123;else&#125; 普通用户 &#123;/if&#125;</span><br></pre></td></tr></table></figure>
<p>循环语法 - <code>&#123;loop $list $row&#125;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">使用循环语法 遍历某个集合的内容. 示例:</span><br><span class="line">&#123;loop $wechats $wechat&#125; &lt;li&gt;Name: &#123;$wechat[&#x27;name&#x27;]&#125;&lt;/li&gt; &#123;/loop&#125;</span><br><span class="line">使用扩展的语法 &#123;$loop $list $key $wechat&#125; 来遍历集合的键名和键值, 例如:</span><br><span class="line">&#123;loop $wechats $weid $wechat&#125; &lt;li&gt;Id: &#123;$key&#125;; Name: &#123;$wechat[&#x27;name&#x27;]&#125;&lt;/li&gt; &#123;/loop&#125;</span><br></pre></td></tr></table></figure>
<p>模板嵌套 - <code>&#123;template $name&#125;</code></p>
<p>在模板的当前位置嵌入另一个模板, 例如: 使用 {template common/header} 来嵌入标准页头.</p>
<p>PHP语法嵌入 - <code>&#123;php statement&#125;</code></p>
<p>使用 PHP 语法嵌入标记, 例如:</p>
<p><code>&#123;php echo date('Y-m-d H:i:s', $row['dateline']);&#125;</code></p>
<p>数据获取标签</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;data module=&quot;&quot; func=&quot;&quot; return=&quot;&quot; item=&quot;&quot; limit=&quot;&quot; assign=&quot;&quot;&#125;&#123;/data&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func - 指定获取数据的函数，此函数定义在模块目录下的model.php文件中</span><br><span class="line">module - 指定获取数据的模块。</span><br><span class="line">assign - 指定该标签得到数据后，存入的变量名称。如果为空则存在与func同名的变量中，方便在下方的代码中使用。</span><br><span class="line">item - 指定循环体内的迭代时的变量名。相当于</span><br><span class="line">foreach ($foo as $i =&gt; $row)中 $row变量。</span><br><span class="line"></span><br><span class="line">limit - 指定获取变量时条数。</span><br><span class="line">return - 为true时，获取到数据后直接循环输出，为false时，获取到数据后作为变量返回。默认为false</span><br><span class="line"></span><br><span class="line">目前支持的获取数据func</span><br><span class="line">&#123;data func=&quot;site*slide*search&quot;&#125; 获取微站幻灯片</span><br><span class="line">获取出4条幻灯片数据，示例:</span><br><span class="line">&#123;data module=&quot;&quot; func=&quot;site_slide_search&quot; return=&quot;&quot; item=&quot;row&quot; limit=&quot;4&quot;&#125; &lt;li&gt;Name: &#123;$row[&#x27;name&#x27;]&#125;&lt;/li&gt; &#123;/data&#125;</span><br><span class="line"></span><br><span class="line">&#123;data func=&quot;site_article&quot; cid=$cid return=&quot;true&quot; assign=&quot;result&quot; iscommend=&quot;true&quot; ishot=&quot;true&quot;&#125;</span><br><span class="line">说明: 根据当前分类$cid获取文章列表，把数据存放在result变量中。此数组中包含list数据和pager数据，iscommend 表示推荐文章，ishot表示热门文章。此标签可同时使用，也可单个使用。示例：</span><br><span class="line">&#123;data module=&quot;site&quot; func=&quot;site_article&quot; cid=$cid return=&quot;true&quot; assign=&quot;result&quot;&#125; </span><br><span class="line">&#123;loop $result[&#x27;list&#x27;] $row&#125; &lt;li&gt;&lt;a href=&quot;&#123;$row[&#x27;url&#x27;]&#125;&quot;&gt;&#123;$row[&#x27;title&#x27;]&#125;&lt;/a&gt;&lt;/li&gt; &#123;/loop&#125; &#123;$result[&#x27;pager&#x27;]&#125;`</span><br><span class="line"></span><br><span class="line">&#123;data func=&quot;site_category&quot; parentid=&quot;0&quot;&#125;</span><br><span class="line">说明：获取当前分类列表，parentid指定获取某个分类的子类。parentid为0是则获取所有的父分类，默认是获取全部分类，示例：</span><br><span class="line">&#123;data module=&quot;site&quot; func=&quot;site_category&quot;&#125;&#123;$row[&#x27;name&#x27;]&#125;&#123;loop $row[&#x27;children&#x27;] $item&#125;&#123;$item[&#x27;name&#x27;]&#125;&#123;/loop&#125;&#123;/data&#125;</span><br></pre></td></tr></table></figure>
<p>参考链接：<a href="http://www.360doc.com/content/19/0726/15/65525851_851144335.shtml">http://www.360doc.com/content/19/0726/15/65525851_851144335.shtml</a></p>
<h3 id="微擎sql调用"><a class="markdownIt-Anchor" href="#微擎sql调用"></a> 微擎sql调用：</h3>
<p><strong>引号：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- 在能使用单引号的情况下，禁止使用双引号。</span><br><span class="line">- 字符串为固定值,不包含换号、制表等特殊转义时，需使用单引号。</span><br><span class="line">- 字符串作为数据索引时，需使用单引号。</span><br><span class="line">- 字符串不需要带入变量，需使用单引号。</span><br><span class="line">- 数据库SQL语句中，所有数据必须加单引号，无论数值还是字串，以避免可能的注入漏洞和SQL错误。</span><br></pre></td></tr></table></figure>
<p><strong>SQL查询：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- 所有数据库查询时，尽量使用封装的 pdo_getXXX 系列函数，如果无法满足再考虑书写SQL语句使用 pdo_fetchXXX 系列函数</span><br><span class="line">- 所有SQL查询关键字大写，方便代码审查</span><br><span class="line">- 所有SQL对象（表名，字段名，索引名等）必须用反引号包括</span><br><span class="line">- 所有编码参数查询，必须使用PDO的参数绑定机制处理</span><br><span class="line">- 不能绑定参数处理的查询，必须处理好变量检测及字符串转义</span><br></pre></td></tr></table></figure>
<p><strong>SQL操作</strong></p>
<p>增：int | boolean</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pdo_insert($tablename, $data = array(), $replace = false)</span><br><span class="line">//案例</span><br><span class="line">$arr=[&#x27;name&#x27;=&gt;&#x27;英语&#x27; ];</span><br><span class="line">$result = pdo_insert(&#x27;health_moniter_category&#x27;, $arr,  false);</span><br></pre></td></tr></table></figure>
<p>删：int | boolean</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pdo_delete($tablename, $condition = array(), $glue = &#x27;AND&#x27;)</span><br><span class="line">//例句</span><br><span class="line">$result = pdo_delete(&#x27;health_moniter_category&#x27;, array(&#x27;id&#x27;=&gt;3));</span><br><span class="line">       var_dump($result)</span><br></pre></td></tr></table></figure>
<p>改：array | boolean</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pdo_update($tablename, $data = array(), $condition, $glue = &#x27;AND&#x27;)</span><br><span class="line">//例句</span><br><span class="line"> $result = pdo_update(&#x27;health_moniter_category&#x27;, array(&#x27;name&#x27;=&gt;&#x27;web编程&#x27;), array(&#x27;id&#x27;=&gt;1));</span><br></pre></td></tr></table></figure>
<p>查：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">查单条：array | boolean</span><br><span class="line">pdo_get($tablename, $condition = array(), $fields = array());</span><br><span class="line">//例如</span><br><span class="line">$result = pdo_get(&#x27;health_moniter_course&#x27;, array(&#x27;id&#x27;=&gt;1), array());</span><br><span class="line">占位符：</span><br><span class="line">$chat=pdo_fetch(&quot;SELECT * FROM&quot; . tablename(&#x27;longbing_card_chat&#x27;) .</span><br><span class="line">            &quot;WHERE user_id=:user_id AND target_id=:target_id OR user_id=:target_id </span><br><span class="line">            AND target_id=:user_id&quot;,[&#x27;:user_id&#x27;=&gt;$uid,&#x27;:target_id&#x27;=&gt;$_GPC[&#x27;to_uid&#x27;]])</span><br><span class="line"></span><br><span class="line">查多条：array | boolean</span><br><span class="line">pdo_getall($tablename, $condition = array(), $fields = array(), $keyfield = &#x27;&#x27;,$orderby = array(), $limit = array());</span><br><span class="line">//例句</span><br><span class="line">$user1 = pdo_getall(&#x27;users&#x27;, array(&#x27;status&#x27; =&gt; 1), array() , &#x27;&#x27; , &#x27;uid DESC&#x27; , array(1,10));</span><br><span class="line">fetchall:</span><br><span class="line"> $save_count = &quot;SELECT COUNT(id) as `count` FROM &quot; . tablename(&#x27;longbing_card_count&#x27;) . &quot; WHERE (uniacid = &#123;$uniacid&#125; &amp;&amp; sign = &#x27;copy&#x27; &amp;&amp; `type` = 2) OR (uniacid = &#123;$uniacid&#125; &amp;&amp; sign = &#x27;copy&#x27; &amp;&amp; `type` = 1) GROUP BY user_id&quot;;</span><br><span class="line">$save_count = pdo_fetchall($save_count);</span><br><span class="line"></span><br><span class="line">查多表:</span><br><span class="line">$sql=&quot;SELECT cou.*,cate.*  FROM  ims_health_moniter_course as cou inner JOIN ims_health_moniter_category as cate on (cou.category = cate.id)&quot;;</span><br><span class="line">$result = pdo_fetchall($sql);</span><br><span class="line">var_dump($result);</span><br><span class="line"></span><br><span class="line">餐饮添加营销短信菜单，对应控制器、视图和短信模板，及修正万能门店会员分页sql使用错误</span><br></pre></td></tr></table></figure>
<p>参考链接:<a href="http://s.w7.cc/index.php?c=wiki&amp;do=view&amp;id=1&amp;list=173">http://s.w7.cc/index.php?c=wiki&amp;do=view&amp;id=1&amp;list=173</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/09/17/%E5%BE%AE%E6%93%8E%E6%A1%86%E6%9E%B6%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" data-id="cm4xy4sje002l6dli7zbzemod" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP-framework/" rel="tag">PHP-framework</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/10/23/Git%E5%91%BD%E4%BB%A4%E8%A1%A5%E5%85%85%E4%B8%8Erebase%E6%93%8D%E4%BD%9C/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Git命令补充与rebase操作
        
      </div>
    </a>
  
  
    <a href="/2019/09/01/docker-compose-yml%E8%AF%B4%E6%98%8E/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">docker-compose.yml说明</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ComputerNetwork/" rel="tag">ComputerNetwork</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Front-end/" rel="tag">Front-end</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Golang/" rel="tag">Golang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongoDB/" rel="tag">MongoDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OperatingSystem/" rel="tag">OperatingSystem</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP-framework/" rel="tag">PHP-framework</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SoftwareDevelopment/" rel="tag">SoftwareDevelopment</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tool/" rel="tag">Tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm-data-structure/" rel="tag">algorithm-data_structure</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ComputerNetwork/" style="font-size: 15.56px;">ComputerNetwork</a> <a href="/tags/Docker/" style="font-size: 12.22px;">Docker</a> <a href="/tags/Front-end/" style="font-size: 11.11px;">Front-end</a> <a href="/tags/Git/" style="font-size: 13.33px;">Git</a> <a href="/tags/Golang/" style="font-size: 12.22px;">Golang</a> <a href="/tags/Hexo/" style="font-size: 11.11px;">Hexo</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/MongoDB/" style="font-size: 11.11px;">MongoDB</a> <a href="/tags/MySQL/" style="font-size: 20px;">MySQL</a> <a href="/tags/OperatingSystem/" style="font-size: 16.67px;">OperatingSystem</a> <a href="/tags/PHP/" style="font-size: 18.89px;">PHP</a> <a href="/tags/PHP-framework/" style="font-size: 14.44px;">PHP-framework</a> <a href="/tags/Redis/" style="font-size: 15.56px;">Redis</a> <a href="/tags/SoftwareDevelopment/" style="font-size: 17.78px;">SoftwareDevelopment</a> <a href="/tags/Tool/" style="font-size: 12.22px;">Tool</a> <a href="/tags/algorithm-data-structure/" style="font-size: 14.44px;">algorithm-data_structure</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">November 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/12/05/IntelliJ-IDEA/">IntelliJ IDEA</a>
          </li>
        
          <li>
            <a href="/2024/12/03/jmeter/">jmeter</a>
          </li>
        
          <li>
            <a href="/2024/12/01/%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/">分布式数据存储</a>
          </li>
        
          <li>
            <a href="/2024/12/01/%E9%AA%8C%E7%AD%BE%E5%92%8C%E5%8A%A0%E8%A7%A3%E5%AF%86/">验签和加解密</a>
          </li>
        
          <li>
            <a href="/2024/11/30/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E6%A1%86%E6%9E%B6/">分布式事务框架</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2024 abellmz<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>