<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8" />
  
  <title>ThinkPHP | abellmz</title>
  <meta name="author" content="abellmz" />

  
  <meta name="description" content="框架下载地址：版本5.0.24
 http://www.thinkphp.cn/down/framework.html 
TP5
1234567891011121314tp5├─application     应用目录├─extend          扩展类库目录（可定义）├─public         网站对外访问目录├─runtime         运行时目录（可定义）├─vendor          第三方类库目录（Composer）├─thinkphp        框架核心目录├─build.php       自动生成定义文件（参考）├─composer.json   Composer定义文件├─LICENSE.txt     授权说明文件├─README.md       README 文件├─think           命令行工具入口如果在linux环境下面的话，需要给runtime目录755权限。" />
  

  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <meta property="og:title" content="ThinkPHP" />
  <meta property="og:site_name" content="abellmz" />

  
  

  
    <meta property="og:image" content="" />
  

  
  <link href="/css/images/favicon.ico" rel="icon" />
  

  <link rel="alternate" href="/atom.xml" title="abellmz" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  


  <!-- baidu webmaster push -->
  <script src='//push.zhanzhang.baidu.com/push.js'></script>

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">abellmz</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="https://github.com/abellmz" target="_blank" rel="noopener">GitHub</a></li>
    
      <li><a href="http://shop.abellmz.cn/" target="_blank" rel="noopener">Laravel-Shop</a></li>
    
      <li><a href="http://www.yy.abellmz.cn/" target="_blank" rel="noopener">Laravel-yy</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2020-04-13T14:19:24.000Z"><a href="/2020/04/13/ThinkPHP/">2020-04-13</a></time>
      
      
  
    <h1 class="title">ThinkPHP</h1>
  

    </header>
    <div class="entry">
      
        <p>框架下载地址：版本5.0.24</p>
<p> <a href="http://www.thinkphp.cn/down/framework.html" target="_blank" rel="noopener">http://www.thinkphp.cn/down/framework.html</a> </p>
<p>TP5</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">tp5</span><br><span class="line">├─application     应用目录</span><br><span class="line">├─extend          扩展类库目录（可定义）</span><br><span class="line">├─public         网站对外访问目录</span><br><span class="line">├─runtime         运行时目录（可定义）</span><br><span class="line">├─vendor          第三方类库目录（Composer）</span><br><span class="line">├─thinkphp        框架核心目录</span><br><span class="line">├─build.php       自动生成定义文件（参考）</span><br><span class="line">├─composer.json   Composer定义文件</span><br><span class="line">├─LICENSE.txt     授权说明文件</span><br><span class="line">├─README.md       README 文件</span><br><span class="line">├─think           命令行工具入口</span><br><span class="line"></span><br><span class="line">如果在linux环境下面的话，需要给runtime目录755权限。</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">├─thinkphp 框架系统目录</span><br><span class="line">│  ├─lang               语言包目录</span><br><span class="line">│  ├─library            框架核心类库目录</span><br><span class="line">│  │  ├─think           think 类库包目录</span><br><span class="line">│  │  └─traits          系统 traits 目录</span><br><span class="line">│  ├─tpl                系统模板目录</span><br><span class="line">│  │</span><br><span class="line">│  ├─.htaccess          用于 apache 的重写</span><br><span class="line">│  ├─.travis.yml        CI 定义文件</span><br><span class="line">│  ├─base.php           框架基础文件</span><br><span class="line">│  ├─composer.json      composer 定义文件</span><br><span class="line">│  ├─console.php        控制台入口文件</span><br><span class="line">│  ├─convention.php     惯例配置文件</span><br><span class="line">│  ├─helper.php         助手函数文件（可选）</span><br><span class="line">│  ├─LICENSE.txt        授权说明文件</span><br><span class="line">│  ├─phpunit.xml        单元测试配置文件</span><br><span class="line">│  ├─README.md          README 文件</span><br><span class="line">│  └─start.php          框架引导文件</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">├─application           应用目录（可设置）</span><br><span class="line">│  ├─index              模块目录(可更改)</span><br><span class="line">│  │  ├─config.php      模块配置文件</span><br><span class="line">│  │  ├─common.php      模块公共文件</span><br><span class="line">│  │  ├─controller      控制器目录</span><br><span class="line">│  │  ├─model           模型目录</span><br><span class="line">│  │  └─view            视图目录</span><br><span class="line">│  │</span><br><span class="line">│  ├─command.php        命令行工具配置文件</span><br><span class="line">│  ├─common.php         应用公共文件</span><br><span class="line">│  ├─config.php         应用配置文件</span><br><span class="line">│  ├─tags.php           应用行为扩展定义文件</span><br><span class="line">│  ├─database.php       数据库配置文件</span><br><span class="line">│  └─route.php          路由配置文件</span><br></pre></td></tr></table></figure>

<p> <strong>引导文件</strong></p>
<p>start.php文件就是系统默认的一个引导文件 </p>
<p>在引导文件中，会依次执行下面操作：</p>
<ul>
<li><p>加载系统常量定义； </p>
</li>
<li><p>加载环境变量定义文件； </p>
</li>
<li><p>注册自动加载机制； </p>
</li>
<li><p>注册错误和异常处理机制； </p>
</li>
<li><p>加载惯例配置文件； </p>
</li>
<li><p>执行应用； </p>
<p>start.php引导文件首先会调用base.php基础引导文件，某些特殊需求下面可能直接在入口文件中引入基础引导文件 </p>
</li>
</ul>
<h4 id="控制器与模板跳转"><a href="#控制器与模板跳转" class="headerlink" title="控制器与模板跳转"></a>控制器与模板跳转</h4><p><strong>控制器-&gt;模板</strong></p>
<p> 内置了一个基于XML的编译型模板引擎 </p>
<p> 控制器类继承think\Controller类之后，可以直接使用封装好的assign和fetch方法进行模板变量赋值和渲染输出 </p>
<p>控制器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public function index()</span><br><span class="line">&#123;</span><br><span class="line">$data = Db::name(&apos;data&apos;)---&gt;find();</span><br><span class="line">$this-&gt;assign(&apos;result&apos;, $data);</span><br><span class="line">$this-&gt;assign([</span><br><span class="line">&apos;temp_id&apos;=&gt;$temp_id,</span><br><span class="line">&apos;templateinfo&apos;=&gt;$temptinfo,</span><br><span class="line">&apos;members&apos;=&gt;$mems</span><br><span class="line">]);</span><br><span class="line">return $this-&gt;fetch();</span><br><span class="line">return $this-&gt;fetch(&apos;add&apos;);//</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>视图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;$result.id&#125;--&#123;$result.data&#125;//1--thinkphp</span><br><span class="line"></span><br><span class="line">模板标签的用法和Smarty类似，就是用于输出数据的字段，这里表示输出think_data表的id和data字段的值。</span><br></pre></td></tr></table></figure>

<p> 若fetch方法中没有指定任何模板，则按照系统默认的规则（视图目录/控制器/操作方法）输出了view/index/hello.html模板文件 </p>
<p><strong>模板-&gt;控制器</strong></p>
<p> 5.0的URL访问受路由决定，如果关闭路由或者没有匹配路由的情况下，则是基于 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://serverName/index.php（或者其它应用入口文件）/模块/控制器/操作/参数/值...</span><br></pre></td></tr></table></figure>

<p>重定向：return  $this-&gt;redirect(‘index/login/index’);（模块名/控制器/方法）</p>
<p>系统渲染模板 return view(‘index/login/index’);//不经过方法，直达视图</p>
<p>或者return $this-&gt;fetch()，默认模板。$this-&gt;fetch(‘XXX’)，指定跳到xxx模板，与view()相同</p>
<p>thinkphp视图中{：url()}或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">//配合ajax的提示后的加载</span><br><span class="line">        $(&quot;#addForm&quot;).submit(function()&#123;</span><br><span class="line">            // $(&apos;#save&apos;).attr(&apos;disabled&apos;,true);</span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                url: &quot;&#123;:\\think\\Url::build(&apos;contract/addfirst&apos;)&#125;&quot;,</span><br><span class="line">                data: $(this).serialize(),</span><br><span class="line">                dataType: &quot;json&quot;,</span><br><span class="line">                type: &quot;post&quot;,</span><br><span class="line">                success: function(data)&#123;</span><br><span class="line">                    if (data.code==1) &#123;</span><br><span class="line">                        if (data.code === 1) &#123;</span><br><span class="line">                            parent.layer.msg(data.msg, &#123;icon: 1, time: 1500&#125;);</span><br><span class="line">                            window.location.href = &quot;&#123;:\\think\\Url::build(\&apos;contract/contractfirst\&apos;)&#125;&quot;;</span><br><span class="line">                        &#125; else &#123;</span><br><span class="line">                            parent.layer.msg(data.msg, &#123;icon: 2&#125;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        parent.layer.msg(&apos;服务器错误，请重试&apos;, &#123;icon: 2&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line"></span><br><span class="line">            &#125;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<p>模块和模块之间的关系</p>
<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a><strong>其他</strong></h4><p> <strong>数据库配置</strong>文件application/database.php中添加数据库的连接信息 </p>
<p><strong>添加模块</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php think build --module demo(模块名)</span><br></pre></td></tr></table></figure>

<p><strong>调试模式：</strong> 应用配置文件（application/config.php） </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 关闭调试模式</span><br><span class="line">&apos;app_debug&apos; =&gt;  false,</span><br><span class="line">避免泄露你的服务器WEB目录信息等资料，一定记得正式部署的时候关闭调试模式。</span><br></pre></td></tr></table></figure>

<p> <strong>命名空间</strong></p>
<p>app命名空间通常表示文件的起始目录为application，而think命名空间则表示文件的目录为thinkphp/library/think </p>
<p> <strong>有几个关键的路径</strong> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tp5	            项目根目录	       ROOT_PATH</span><br><span class="line">tp5/application	应用目录	        APP_PATH</span><br><span class="line">tp5/thinkphp	框架核心目录	       THINK_PATH</span><br><span class="line">tp5/exend	    应用扩展目录	       EXTEND_PATH</span><br><span class="line">tp5/vendor	    Composer扩展目录	VENDOR_PATH</span><br></pre></td></tr></table></figure>

<h4 id="路由共有4种形式"><a href="#路由共有4种形式" class="headerlink" title="路由共有4种形式"></a>路由共有4种形式</h4><ol>
<li>基本get形式<br>http://域名/index.php?m=分组&amp;c=控制器&amp;a=操作方法<br>该方式是最底层的get形式、传统的参数传递方式，不时尚、不安全。</li>
<li>pathinfo路径形式[默认方式]<br>http://域名/index.php/分组/控制器/操作方法<br>http://域名/index.php/Home/Index/advert</li>
<li>rewrite重写形式(伪静态技术)省略index.php入口文件<br>http://域名/分组模块/控制器/操作方法（用过了）<br>http://域名/Home/Index/index</li>
<li>兼容形式<br>http://域名/index.php?s=/分组/控制器/操作方法<br>http:/域名/index.php?s=/Home/Index/advert</li>
</ol>
<p>参考链接：</p>
<p> <a href="https://www.w3cschool.cn/thinkphp/xi581rtn.html" target="_blank" rel="noopener">https://www.w3cschool.cn/thinkphp/xi581rtn.html</a> </p>
<p><a href="https://blog.csdn.net/voke_/article/details/78766663" target="_blank" rel="noopener">https://blog.csdn.net/voke_/article/details/78766663</a><br><a href="https://blog.csdn.net/weixin_39768635/article/details/78195443" target="_blank" rel="noopener">https://blog.csdn.net/weixin_39768635/article/details/78195443</a></p>
<p>数据库配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yunyi\application\extra\database_news.php(数据库配置文件)</span><br><span class="line">yunyi\application\database.php（这个才是）</span><br></pre></td></tr></table></figure>

<h3 id="sql调用："><a href="#sql调用：" class="headerlink" title="sql调用："></a><strong>sql调用：</strong></h3><h5 id="原生的："><a href="#原生的：" class="headerlink" title="原生的："></a><strong>原生的：</strong></h5><p>TP的模型可以支持原生SQL操作，提供了query和execute两个方法 </p>
<p>query用于查询，返回的是数据集，和select或者findall一样，所以可以直接在模板里面使用volist标签输出query的查询结果，注意query是查功能、插入</p>
<p>execute用于写操作，返回的是状态或者影响的记录数，注意execute是增删改功能</p>
<p>只是需要new一个空的模型继承Model中的方法</p>
<p><strong>查</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$Model = new Model();//或者 $Model = D(); 或者 $Model = M();</span><br><span class="line">$sql = &quot;select * from `order`&quot;;</span><br><span class="line">$voList = $Model-&gt;query($sql);</span><br><span class="line"></span><br><span class="line">Db::query(&quot;select * from think_user where status=1&quot;);</span><br><span class="line">如果你当前采用了分布式数据库，并且设置了读写分离的话，query方法始终是在读服务器执行，因此query方法对应的都是读操作，而不管你的SQL语句是什么。</span><br></pre></td></tr></table></figure>

<p><strong>增删改</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$voList = $Model-&gt;execute(&apos;update think_user set status=1 where id=1&apos;);</span><br><span class="line"></span><br><span class="line">Db::execute(&quot;update think_user set name=&apos;thinkphp&apos; where status=1&quot;);</span><br><span class="line">如果你当前采用了分布式数据库，并且设置了读写分离的话，execute方法始终是在写服务器执行，因此execute方法对应的都是写操作，而不管你的SQL语句是什么。</span><br></pre></td></tr></table></figure>

<h5 id="封装的："><a href="#封装的：" class="headerlink" title="封装的："></a><strong>封装的：</strong></h5><p><strong>增(add)</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$model = M(&apos;WxuserCollection&apos;);</span><br><span class="line">$data = array(&apos;user_id&apos; = &gt;$user_id, &apos;store_id&apos; = &gt;$store_id, &apos;good_id&apos; = &gt;$good_id, &apos;addtime&apos; = &gt;$addtime);</span><br><span class="line">$model - &gt;data($data) - &gt;add();</span><br><span class="line"></span><br><span class="line">$User = M(&quot;User&quot;); // 实例化User对象</span><br><span class="line">$User-&gt;where(&apos;id=5&apos;)-&gt;setInc(&apos;score&apos;,3); // 用户的积分加3</span><br><span class="line">$User-&gt;where(&apos;id=5&apos;)-&gt;setInc(&apos;score&apos;); // 用户的积分加1</span><br><span class="line">$User-&gt;where(&apos;id=5&apos;)-&gt;setDec(&apos;score&apos;,5); // 用户的积分减5</span><br><span class="line">$User-&gt;where(&apos;id=5&apos;)-&gt;setDec(&apos;score&apos;); // 用户的积分减1</span><br></pre></td></tr></table></figure>

<p><strong>改(edit)</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$model = M(&apos;WxuserCollection&apos;);</span><br><span class="line">$data = array(&apos;user_id&apos; = &gt;$user_id, &apos;store_id&apos; = &gt;$store_id, &apos;good_id&apos; = &gt;$good_id, &apos;addtime&apos; = &gt;$addtime);</span><br><span class="line">$model - &gt;data($data) - &gt;where(&apos;id=3&apos;) - &gt;save();</span><br><span class="line"></span><br><span class="line">$goods=D(&quot;emptest&quot;);</span><br><span class="line">$goods-&gt;name=&quot;Cool&quot;;</span><br><span class="line">$goods-&gt;garde=&quot;2&quot;;</span><br><span class="line">$goods-&gt;email=&quot;Cool@qq.com&quot;;</span><br><span class="line">$goods-&gt;salary=&quot;7777&quot;;</span><br><span class="line">$goods-&gt;where(&apos;id=2&apos;)-&gt;save();</span><br><span class="line"></span><br><span class="line">$goods=M(&quot;emptest&quot;);</span><br><span class="line">$arr=array(&apos;id&apos;=&gt;&apos;7&apos;,&apos;name&apos;=&gt;&apos;xu2xuning&apos;,&apos;salary&apos;=&gt;5555);</span><br><span class="line">$res=$goods-&gt;save($arr);</span><br></pre></td></tr></table></figure>

<p><strong>查（find与select,field,order,join,getField）</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$model = M(&apos;WxuserCollection&apos;);</span><br><span class="line">$res1 = $model - &gt;find(1);</span><br><span class="line">$res2 = $model - &gt;find(2);</span><br><span class="line">$res3 = $model - &gt;where(&apos;good_id=1105 AND store_id = 1 AND user_id = 20&apos;) - &gt;find();</span><br><span class="line"></span><br><span class="line">find(1)获取id为1的数据，find(2)获取id为2的数据。最后一个是获取条件为where的中的第一条数据</span><br><span class="line">$model = M(&apos;WxuserCollection&apos;);</span><br><span class="line">$res = $model - &gt;where(&apos;good_id=1105 AND store_id = 1 AND user_id = 20&apos;) - &gt;field(&apos;id,good_id as good&apos;) - &gt;select();</span><br><span class="line">获取所有数据。这里的好处就是，不用考虑sql语句的顺序了，随心所欲调用函数就可以了</span><br><span class="line"></span><br><span class="line">$res = $model - &gt;field(&apos;id,good_id as good&apos;) - &gt;select();</span><br><span class="line">$res = $model - &gt;field(array(&apos;id&apos;, &apos;good_id&apos; = &gt;&apos;good&apos;)) - &gt;select();</span><br><span class="line">$res = $model - &gt;field(&apos;id&apos;, true) - &gt;select();</span><br><span class="line">字符串，数组两种方式，第三个是表示获取处理id之外的所有字段</span><br><span class="line"></span><br><span class="line">$res = $model - &gt;order(&apos;id desc&apos;) - &gt;select();</span><br><span class="line">$res = $model - &gt;order(array(&apos;id&apos; = &gt;&apos;desc&apos;)) - &gt;select();</span><br><span class="line">字符串，数组两种方式，默认asc。</span><br><span class="line"></span><br><span class="line">$Model-&gt;join(&apos; work ON artist.id = work.artist_id&apos;)-&gt;join(&apos;card ON artist.card_id = card.id&apos;)-&gt;select();</span><br><span class="line">$Model-&gt;join(&apos;RIGHT JOIN work ON artist.id = work.artist_id&apos;)-&gt;select();</span><br><span class="line">$Model-&gt;join(array(&apos; work ON artist.id = work.artist_id&apos;,&apos;card ON artist.card_id = card.id&apos;))-&gt;select();</span><br><span class="line">默认采用LEFT JOIN 方式，如果需要用其他的JOIN方式，可以改成第二种，</span><br><span class="line">如果join方法的参数用数组的话，只能使用一次join方法，并且不能和字符串方式混合使用。</span><br></pre></td></tr></table></figure>

<p>getfield</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 获取ID为3的用户的昵称 ,即使有满足条件的多个字段，也只会返回一个结果</span><br><span class="line">$nickname = $User-&gt;where(&apos;id=3&apos;)-&gt;getField(&apos;nickname&apos;);</span><br><span class="line">返回的nickname则是一个数组，包含了所有满足条件的昵称列表。</span><br><span class="line">$nickname = $User-&gt;where(&apos;status=1&apos;)-&gt;getField(&apos;nickname&apos;,true);</span><br><span class="line">限制返回结果数量</span><br><span class="line">$nickname = $User-&gt;where(&apos;status=1&apos;)-&gt;getField(&apos;nickname&apos;,8);</span><br><span class="line"></span><br><span class="line">2字段名称的话，默认返回一个关联数组，以第一个字段的值为索引（所以第一个字段要尽量选择不会重复的）</span><br><span class="line">$nickname = $User-&gt;where(&apos;status=1&apos;)-&gt;getField(&apos;id,nickname&apos;);</span><br><span class="line">2个以上的字段名，则返回一个二维关联数组（类似select方法的返回值，区别在于索引是二维数组的键名是第一个字段的值）</span><br><span class="line">$result = $User-&gt;where(&apos;status=1&apos;)-&gt;getField(&apos;id,account,nickname&apos;);</span><br></pre></td></tr></table></figure>

<p><strong>删(delete)</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$model = M(&apos;WxuserCollection&apos;);</span><br><span class="line">$res = $model - &gt;where(&apos;id=1&apos;) - &gt;delete(); // 成功返回1 失败返回0</span><br><span class="line">$model-&gt;delete(9);//删除指定主键的数据行</span><br><span class="line">$model-&gt;delete(”1,2,3“);//也可以删除多个主键的值得行,一定要带引号</span><br><span class="line">$model-&gt;where(&quot;id&gt;=13 and id&lt;=18&quot;)-&gt;delete();//条件性的删除操作</span><br></pre></td></tr></table></figure>

<p><strong>实践</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$where = array(&apos;a.store_id&apos; =&gt; $this-&gt;store_id, &apos;a.user_id&apos; =&gt; $this-&gt;user_id);</span><br><span class="line">$collects = $this-&gt;collectModel-&gt;table(&quot;sh_wxuser_collection a&quot;)-&gt;field(array(&apos;b.name&apos;,&apos;b.price&apos;,&apos;b.oprice&apos;,&apos;b.logoimg&apos;,&apos;a.goods_id&apos;))-&gt;limit($start, $offset)-&gt;order(&apos;a.addtime DESC&apos;)-&gt;where($where)-&gt;join(&apos; sh_goods b ON a.goods_id = b.id&apos;)-&gt;select();// 获取当前页的记录</span><br><span class="line">echo M()-&gt;getLastSql();  // 调试sql语句用</span><br><span class="line">$count = $this-&gt;collectModel-&gt;table(&quot;sh_wxuser_collection a&quot;)-&gt;where($where)-&gt;count(); // 获取总的记录数</span><br></pre></td></tr></table></figure>

<p>参考链接： <a href="https://www.cnblogs.com/jiqing9006/p/4975293.html" target="_blank" rel="noopener">https://www.cnblogs.com/jiqing9006/p/4975293.html</a> </p>
<h3 id="OOP与AOP"><a href="#OOP与AOP" class="headerlink" title="OOP与AOP"></a><strong>OOP与AOP</strong></h3><p> Aspect Oriented Programming（AOP） 面向切面编程</p>
<p>例如：对 “权限检查”这一<strong>动作</strong>片断进行封装</p>
<p> Object Oriented Programming （OOP）面向对象编程</p>
<p>例如：将“雇员”相关的属性和行为封装入 “Employee”类中 </p>

      
    </div>
    
    <footer>
        <div class="alignright">
          
          <a href='javascript:void(0)' target="_blank" rel="noopener" class="share-link bdsharebuttonbox" data-cmd="more">分享</a>
        </div>
        
        
  
  <div class="tags">
    <a href="/tags/PHP框架/">PHP框架</a>
  </div>

        <!-- partial('post/share') -->
      <div class="clearfix"></div>

    </footer>
  </div>
</article>






<div id="lv-container" data-id="city" data-uid="MTAyMC80Mjc5OC8xOTM0NQ==">
	<script type="text/javascript">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];

       if (typeof LivereTower === 'function') { return; }

       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;

       e.parentNode.insertBefore(j, e);
   })(document, 'script');
	</script>
<noscript> 为正常使用来必力评论功能请激活JavaScript</noscript>
</div>
</div></div>
    <aside id="sidebar" class="alignright">
  

  
<div class="widget tag">
  <h3 class="title">Recent Posts</h3>
  <ul class="entry">
    
      <li>
        <a href="/2020/08/25/Nginx比Apache支持高并发/">Nginx比Apache支持高并发</a>
      </li>
    
      <li>
        <a href="/2020/06/15/Sessiong表配置/">Sessiong表配置</a>
      </li>
    
      <li>
        <a href="/2020/06/08/mongoDB/">MongoDB01</a>
      </li>
    
      <li>
        <a href="/2020/05/03/PDO/">PDO</a>
      </li>
    
      <li>
        <a href="/2020/04/25/Smarty/">Smarty</a>
      </li>
    
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/Docker/">Docker</a><small>3</small></li>
  
    <li><a href="/tags/Git/">Git</a><small>5</small></li>
  
    <li><a href="/tags/Hexo/">Hexo</a><small>3</small></li>
  
    <li><a href="/tags/Linux/">Linux</a><small>2</small></li>
  
    <li><a href="/tags/Markdown/">Markdown</a><small>1</small></li>
  
    <li><a href="/tags/MongoDB/">MongoDB</a><small>1</small></li>
  
    <li><a href="/tags/MySQL/">MySQL</a><small>2</small></li>
  
    <li><a href="/tags/PDO/">PDO</a><small>1</small></li>
  
    <li><a href="/tags/PHP/">PHP</a><small>10</small></li>
  
    <li><a href="/tags/PHP框架/">PHP框架</a><small>7</small></li>
  
    <li><a href="/tags/Redis/">Redis</a><small>3</small></li>
  
    <li><a href="/tags/Smarty/">Smarty</a><small>1</small></li>
  
    <li><a href="/tags/前端/">前端</a><small>3</small></li>
  
    <li><a href="/tags/工具/">工具</a><small>1</small></li>
  
    <li><a href="/tags/服务器/">服务器</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">Tag Cloud</h3>
  <div class="entry">
    <a href="/tags/Docker/" style="font-size: 14px;">Docker</a> <a href="/tags/Git/" style="font-size: 16px;">Git</a> <a href="/tags/Hexo/" style="font-size: 14px;">Hexo</a> <a href="/tags/Linux/" style="font-size: 12px;">Linux</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/MongoDB/" style="font-size: 10px;">MongoDB</a> <a href="/tags/MySQL/" style="font-size: 12px;">MySQL</a> <a href="/tags/PDO/" style="font-size: 10px;">PDO</a> <a href="/tags/PHP/" style="font-size: 20px;">PHP</a> <a href="/tags/PHP%E6%A1%86%E6%9E%B6/" style="font-size: 18px;">PHP框架</a> <a href="/tags/Redis/" style="font-size: 14px;">Redis</a> <a href="/tags/Smarty/" style="font-size: 10px;">Smarty</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 14px;">前端</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">工具</a> <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 10px;">服务器</a>
  </div>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  <p>
  
  &copy; 2020 abellmz
  
  All rights reserved.</p>
  <p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></p>
</div>
<div class="clearfix"></div>

<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>

</footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


<div id='bg'></div>
</body>
</html>